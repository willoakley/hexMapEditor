<!DOCTYPE html>
<html>
<head>
	<script type="text/javascript" src="http://code.jquery.com/jquery-2.1.0.min.js"></script>
	<script type="text/javascript" src="hexMaths.js"></script>
	<script type="text/javascript" src="gridCompas.js"></script>
	<script type="text/javascript" src="drawableFactory.js"></script>
	<script type="text/javascript" src="newGrid.js"></script>
	<!-- use http://s-yadav.github.io/contextMenu.html for the context menu? -->
	<script type="text/javascript">
		var scale = 16;
		var size = { sx: 10, sy: 10 };
		var grid = null;

		function drawHex(context, sideLength, offsetLeft, offsetTop, fillColour, strokeColour, text) {
			var points = window.hexMaths.hexPointsAtOffset(offsetLeft, offsetTop, sideLength);

			context.beginPath();
			context.moveTo(points[0].x, points[0].y);
			for (var ii = 1; ii < points.length; ii++) {
				context.lineTo(points[ii].x, points[ii].y);
			}

			context.closePath();

			if (fillColour !== undefined && fillColour !== null) {
				context.fillStyle = fillColour;
				context.fill();
			}

			if (strokeColour !== undefined && strokeColour !== null) {
				context.lineWidth = 2;
				context.strokeStyle = strokeColour;
				context.stroke();
			}

			if (text !== undefined && text !== null && text.length > 0) {
				var maxWidth = window.hexMaths.getOffsetWidth(sideLength);
				var textLeft = offsetLeft + (window.hexMaths.getWidth(sideLength) / 2.0);
				var textTop = offsetTop + (window.hexMaths.getHeight(sideLength) / 2.0);

				context.fillStyle = strokeColour;
				context.textAlign = 'center';
				context.font = "bold " + (sideLength / 2) + "px Arial";
				context.fillText(text, textLeft, textTop, maxWidth);
			}
		}

		function newGridIndex(x, y) {
			return { gx: x, gy: y };
		};

		$(document).ready(function () {
			grid = window.newGrid(scale, size);

			var dummyDraw = function (context, pixelLocation, scale, rotation) {
				drawHex(context, scale, pixelLocation.px, pixelLocation.py, "grey", "black", "F:"+rotation)
			};

			var singleItem = window.drawableFactory.newDrawableSingle("dummy", dummyDraw);
			grid.addItem(window.newGridIndex(1, 1), "n", singleItem);

			var multipleItem = window.drawableFactory.newDrawableMultiple(
				"dummyTwo",
				[
					{ draw: dummyDraw },
					{ move: "s", draw: dummyDraw },
					{ move: "s" },
					{ move: "s", draw: dummyDraw },
				]
			);
			grid.addItem(window.newGridIndex(3, 3), "ne", multipleItem);

			var context = $("#canvas")[0].getContext("2d");
			grid.draw(context);
		});
	</script>
</head>
<body>
	start.
	<canvas id="canvas" width="944" height="800"></canvas>
	done.
</body>
</html>