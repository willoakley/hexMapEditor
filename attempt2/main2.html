<!DOCTYPE html>
<html>
<head>
	<script type="text/javascript" src="http://code.jquery.com/jquery-2.1.0.min.js"></script>
	<script type="text/javascript" src="hexMaths.js"></script>
	<script type="text/javascript" src="gridCompas.js"></script>
	<script type="text/javascript" src="drawableFactory.js"></script>
	<script type="text/javascript" src="newGrid.js"></script>
	<script type="text/javascript" src="drawFuncs.js"></script>
	<!-- use http://s-yadav.github.io/contextMenu.html for the context menu? -->
	<script type="text/javascript">
		var hexScale = 16;
		var tileScale = hexScale * 7;
		var hexGrid = null;
		var tileGrid = null;
		var canvasElement = null;

		function newGridIndex(x, y) {
			return { gx: x, gy: y };
		};

		function drawCanvas() {
			var context = canvasElement[0].getContext("2d");

			tileGrid.draw(context);
			hexGrid.draw(context);
		};

		$(document).ready(function () {
			tileGrid = window.newGrid(tileScale, { sx: 4, sy: 4 });
			hexGrid = window.newGrid(hexScale, { sx: 10, sy: 10 });

			hexGrid.addItem(window.newGridIndex(0, 0), "n", window.drawableFactory.newDrawableSingle("dummy", window.drawFuncs.dummyDraw));
			// turn this off while playing with inner grids on tiles
			hexGrid.addItem(window.newGridIndex(3, 3), "ne", window.drawableFactory.newDrawableMultiple(
				"dummyTwo",
				[
					{ draw: window.drawFuncs.dummyDraw },
					{ move: "s", draw: window.drawFuncs.dummyDraw },
					{ move: "s" },
					{ move: "s", draw: window.drawFuncs.dummyDraw },
				]
			));

			tileGrid.addItem(window.newGridIndex(0, 0), "ne", window.drawableFactory.newDrawableSingle("dummyTile", window.drawFuncs.dummyDrawTile));

			canvasElement = $("#canvas");
			drawCanvas();

			canvasElement.click(function (e) {
				var pos = { px: e.pageX - canvasElement.offset().left, py: e.pageY - canvasElement.offset().top };
				var clickedIndex = hexGrid.getGridIndexFormPixelLocation(pos);
				// TODO: hilight item at position on hex grid or fall back and hilight hex
				console.log("clicked index " + JSON.stringify(clickedIndex));
			});
		});
	</script>
</head>
<body>
	start.
	<canvas id="canvas" width="944" height="800"></canvas>
	done.
</body>
</html>